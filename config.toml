# WireGuard Failover Configuration File
# =====================================
#
# This configuration file defines the settings for the WireGuard Failover system.
# The system automatically monitors connectivity to a WireGuard peer and switches
# between primary and secondary network interfaces when connectivity issues are
# detected. It also performs speed optimization when both interfaces are available.
#
# File Location: /etc/wg-failover/config.toml
#
# Features:
# - Automatic failover when interface connectivity is lost
# - Speed-based optimization to use faster connections
# - Anti-flapping protection (minimum time between switches)
# - Auto-recovery to primary when both interfaces are available
# - Multiple IP testing for better connectivity assessment
# - Option to route all traffic or just WireGuard peer traffic

# WireGuard Peer Configuration
# ----------------------------
# Defines the WireGuard peer that will be monitored for connectivity.
[peer]
# Public IP address or hostname of the WireGuard peer to monitor.
# This is the endpoint that will be pinged to test connectivity.
# Example: ip = "203.0.113.1" (for a public IP)
# Example: ip = "vpn.example.com" (for a hostname)
ip = "206.189.140.174"

# WireGuard Interface Configuration
# ---------------------------------
# Defines the WireGuard interface that will be managed by the failover system.
[wireguard]
# Name of the WireGuard interface to monitor and manage.
# This should match the interface name configured in your WireGuard setup.
# Example: interface = "wg0" (most common)
# Example: interface = "wg-vpn" (custom name)
interface = "wg0"

# Network Interface Configuration
# -------------------------------
# Defines the primary and secondary network interfaces for failover.
[interfaces]
# Primary network interface (preferred interface).
# This interface will be used by default and the system will automatically
# recover to this interface when it becomes available.
# Example: primary = "eth0" (Ethernet)
# Example: primary = "enp0s31f6" (specific Ethernet port)
primary = "eno3"

# Secondary network interface (fallback interface).
# This interface will be used when the primary interface loses connectivity.
# Example: secondary = "wlan0" (WiFi)
# Example: secondary = "wwp0s20u4i6" (cellular modem)
secondary = "eno4"

# Test IP Configuration
# ---------------------
# List of IP addresses to test for connectivity.
# The system will test connectivity to all these IPs through each interface
# to determine overall network health. At least 50% of tests must succeed
# for an interface to be considered working.
test_ips = [
    "10.9.0.1",
    "8.8.8.8",        # Google DNS
    "1.1.1.1",        # Cloudflare DNS
    "208.67.222.222", # OpenDNS
    "206.189.140.174", # WireGuard peer (included automatically)
]

# Routing Configuration
# ---------------------
# Controls whether to route all traffic or just WireGuard peer traffic
# through the selected interface.
# When true: All traffic (0.0.0.0/0) will be routed through the selected interface
# When false: Only traffic to the WireGuard peer will be routed through the selected interface
route_all_traffic = true

# Monitoring Configuration
# ------------------------
# Defines the timing and behavior of connectivity and speed monitoring.
[monitoring]
# Connectivity check interval in seconds.
# How often the system checks if the WireGuard peer is reachable.
# Lower values detect failures faster but use more system resources.
# Example: interval = 30 (check every 30 seconds)
# Example: interval = 60 (check every minute)
interval = 30

# Speed test interval in seconds.
# How often the system performs speed tests when both interfaces are working.
# Speed tests help optimize performance by switching to faster interfaces.
# Example: speedtest_interval = 300 (test every 5 minutes)
# Example: speedtest_interval = 3600 (test every hour)
speedtest_interval = 300

# Speed threshold percentage to switch to faster interface.
# Minimum percentage improvement required to switch from primary to secondary.
# Prevents unnecessary switching for minor speed differences.
# Example: speed_threshold = 20 (switch if secondary is 20% faster)
# Example: speed_threshold = 35 (switch if secondary is 35% faster)
speed_threshold = 30

# Number of ping attempts for speed tests.
# More attempts provide more accurate speed measurements but take longer.
# Used only during speed tests, not regular connectivity checks.
# Example: speed_test_count = 5 (5 ping attempts per speed test)
# Example: speed_test_count = 10 (10 ping attempts for more accuracy)
speed_test_count = 5

# Ping timeout in seconds for speed tests.
# How long to wait for each ping response during speed tests.
# Higher values work better on high-latency connections.
# Example: speed_test_timeout = 5 (5 second timeout per ping)
# Example: speed_test_timeout = 10 (10 second timeout for slow links)
speed_test_timeout = 5
